<!-- app/templates/select_files.html -->
{% extends "base.html" %}

{% block content %}
<h2>Dateien/Ordner auswählen für Projekt: {{ project }}</h2>
{% if error %}
<div class="alert alert-danger">{{ error }}</div>
{% endif %}
<form method="post" action="{{ url_for('read_files') }}">
    <div class="form-group">
        <!-- "Alle markieren" Checkbox -->
        <input type="checkbox" id="select_all"> <label for="select_all">Alle markieren</label>
    </div>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Auswahl</th>
                <th>Datei/Ordner</th>
            </tr>
        </thead>
        <tbody>
            {% for item in flat_structure %}
            <tr>
                <td>
                    <input type="checkbox" name="selected_paths" value="{{ item.path }}">
                </td>
                <td style="padding-left: {{ item.indent * 20 }}px;">
                    {% if item.is_dir %}
                        <strong>{{ item.name }}/</strong>
                    {% else %}
                        {{ item.name }}
                    {% endif %}
                    <small> ({{ item.path }})</small>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <button type="submit" class="btn btn-primary">Ausgewählte Dateien auslesen</button>
</form>
<script>
    // JavaScript, um alle Checkboxen per "Alle markieren" zu steuern
    document.getElementById('select_all').addEventListener('change', function() {
        var checkboxes = document.querySelectorAll('input[name="selected_paths"]');
        for (var checkbox of checkboxes) {
            checkbox.checked = this.checked;
        }
    });
</script>
{% endblock %}
